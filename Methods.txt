Methods and Materials
ABCD participants 
We used genetic, neuroimaging, environmental, and phenotypic data from the Adolescent Brain Cognitive Development (ABCD) study (http://abcdstudy.org), specifically from release 2.0 for genetic and neuroimaging data, release 3.0 for genetic ancestry information, and release 5.1 for environmental and phenotypic data. The ABCD study, the largest longitudinal investigation of brain development and child health in the United States, recruited multiethnic children (N=11,875) aged 9-10 years from 21 research sites. The self-reported ethnicities of participants included 52.3% White, 20.3% Hispanic, 14.7% Black, and 12.5% Asian and others. All participants provided informed assent, and their parents or legal guardians provided informed consent before participating in the study.

Genotype Data and Polygenic Scores
The genotype data used in this study were obtained from the ABCD cohort, with DNA samples genotyped at Rutgers University Cell and DNA Repository (RUCDR) using the Affymetrix NIDA Smoke Screen Array. Standard quality control (QC) procedures were applied to remove variants with low genotype call rate and minor allele frequency (MAF). Genotype imputation was performed using the Michigan Imputation Server (Das et al., 2016) with the 1000 Genomes reference panel (Genomes Project et al., 2015). We further filtered out imputed variants that did not meet our QC criteria. To account for population structure and relatedness, principal component analysis (PCA) and kinship-based filtering were used to exclude close relatives (Conomos et al., 2015; Conomos et al., 2016).
Polygenic scores (PGSs) for 30 cognitive, psychiatric, and behavioral traits were calculated based on genome-wide association study (GWAS) summary statistics. These included PGSs for cognitive performance, educational attainment, schizophrenia, bipolar disorder, depression, insomnia, body mass index, and automobile speed propensity, among others. The PGSs were derived using PRS-CS (Ge et al., 2019), a Bayesian regression approach, with optimal hyperparameter selection. 
The genotype data and polygenic scores used in this study are identical to those reported in  (Joo et al., 2025). A complete list of the 30 polygenic scores, along with further methodological details on genotype data processing, GWAS sources, ancestry-based adjustments, and validation procedures can be found in the (Joo et al., 2025).

Environmental Factors
To investigate the relationship between children's brain network properties and their environment, we analyzed 56 variables representing various environmental aspects. These variables included indicators of family and neighborhood socioeconomic status, such as family income, parental education level, marital status, and neighborhood deprivation based on the Area Deprivation Index (ADI). Additionally, variables related to prenatal substance exposure (e.g., tobacco, alcohol, cocaine, and marijuana), as well as parental and family factors such as parental acceptance and family conflict, were included.
To maximize statistical power, we imputed missing data to include as many samples as possible in the analysis. To account for uncertainty in imputing missing values and to improve the accuracy and reliability of the imputed values, we employed the Multiple Imputation by Chained Equations (MICE) method (Van Buuren & Groothuis-Oudshoorn, 2011). We set the number of imputation iterations to 40 to ensure stable convergence. All imputation procedures were conducted using the statsmodels package in Python. To ensure that our analysis was robust to imputation, we also conducted analyses using only the complete data without any missing values and included these results as supplementary material. 

Phenotype Data
To explore the relationship between children's brain network properties and their cognitive ability, mental well-being, and physical health, we examined 86 phenotype variables. To evaluate cognitive ability, we examined the NIH Toolbox measurements, which included fluid, crystallized, and overall cognition scores, along with domain-specific task scores for episodic memory, executive function, language, and processing speed (Weintraub et al., 2013). For assessing the children's mental health, our analysis encompassed a broad range of emotional and behavioral measurements, including instruments such as the Child Behavioral Checklist (CBCL), the Kiddie-Structured Assessment for Affective Disorders and Schizophrenia for DSM-5 (KSADS-5), and the Prodromal Psychosis Scale (PPS). We also included measures of behavioral tendencies, such as behavioral inhibition and activation (BIS/BAS), which assess avoidance behaviors, reward sensitivity, and behavioral control; impulsivity traits (UPPS), which measure dimensions such as urgency, perseverance, and sensation seeking; and sleep-related problems, which provide insights into sleep patterns, quality, and related disorders. For the children's physical health, we included data such as physical activity. To maximize statistical power, missing values in the phenotype data were imputed using the Multiple Imputation by Chained Equations method (Van Buuren & Groothuis-Oudshoorn, 2011).

Structural Brain Network Construction
We used structural and diffusion MRI (dMRI) data acquired by the ABCD study (Casey et al., 2018) from data release 2.0. The dMRI data were initially preprocessed by the ABCD Data Analysis and Informatics Center (DAIC). This protocol included eddy current and head motion correction, diffusion gradient adjustment for head rotation, and B0 distortion correction using the reversing gradient method (Hagler et al., 2019). Gradient nonlinearity distortion correction was applied to improve geometric accuracy, followed by registration to T1-weighted images and resampling to a 1.77 mm isotropic resolution.
To optimize the data for structural network construction, we performed additional preprocessing on the DAIC-processed data using MRtrix3 (Tournier et al., 2019). PCA-based denoising was applied using spatially varying noise estimates, with eigenvalue thresholds determined in a data-driven manner based on the estimated noise level (Veraart et al., 2016). Bias field correction was subsequently performed using the N4 algorithm implemented in Advanced Normalization Tools (ANTs) (Tustison et al., 2010).
Individual structural connectomes were constructed using probabilistic tractography. Prior to tractography, tissue-specific response functions were estimated from the data and fiber orientation distributions (FODs) were computed using constrained spherical deconvolution (CSD) (Calamante et al., 2010; Tournier et al., 2007) to model crossing fibers within each voxel. Based on these FODs, whole-brain tractograms were generated using the second-order integration over fiber orientation distributions (iFOD2) algorithm (Calamante et al., 2010), with random seeding across the brain and a target of 20 million streamlines. To improve biological plausibility and reduce spurious connections, the initial tractograms were filtered using spherical-deconvolution informed filtering of tractograms (SIFT) (Smith et al., 2013), retaining 10 million streamlines per participant. 
Network nodes were defined using the Desikan–Killiany atlas (Desikan et al., 2006), comprising 68 cortical and 16 subcortical regions, derived from individual FreeSurfer segmentations. This atlas was used as the standard anatomical parcellation in the ABCD processing pipeline (Hagler et al., 2019), providing a well-established and interpretable representation of cortical and subcortical organization and facilitating comparability with prior ABCD-based and large-scale developmental studies. The parcellation maps were registered to diffusion space, and an 84 × 84 weighted connectivity matrix was constructed for each participant, resulting in subject-specific structural connectomes aligned to individual neuroanatomy.
In addition to image-level quality control metrics provided by the ABCD Data Analysis and Informatics Center (e.g., fsqc_qc and iqc_dmri_1_qc_score), post-reconstruction quality checks were performed on the connectivity matrices. Specifically, we examined the distribution of total streamline counts across participants to identify potential reconstruction failures. Individuals whose total streamline counts fell within the lowest 1% of the sample were excluded as likely cases of incomplete or unreliable tractography reconstruction. This criterion resulted in the exclusion of 106 participants. The distribution of total streamline counts and the applied exclusion threshold are shown in (Supplementary Figure S1).

Brain Network Measures (BNMs)
We treated each 84 × 84 structural connectome matrix as an undirected, weighted brain network, with nodes corresponding to parcellated gray matter regions and edges representing reconstructed white-matter connections between brain regions. Edge weights were quantified by streamline counts. To mitigate the impact of spurious connections inherent to probabilistic tractography and their influence on network topology, we eliminated extremely weak connections by removing edges with fewer than three streamlines. After thresholding, individuals with at least one isolated node were excluded from subsequent analyses, under the assumption that all brain regions should remain connected via at least one path in a biologically plausible structural network.
Because network topology is known to depend on thresholding strategies (Fornito et al., 2016; Rubinov & Sporns, 2010; van Wijk et al., 2010), we additionally evaluated the robustness of our findings using a group-level consistency-based thresholding approach (Roberts et al., 2017) in supplementary analyses. Specifically, edges were retained only if they were present in at least 60% of participants, thereby removing connections that were not consistently reconstructed across individuals.
We calculated 13 different types of brain network measurements (BNMs) representing different aspects of brain network topology (Rubinov & Sporns, 2010; van den Heuvel & Sporns, 2011). We calculated eight global graph metrics (including network density, modularity, normalized modularity, normalized average clustering coefficient, normalized characteristic path length, global efficiency, normalized global efficiency, small-worldness) and five nodal graph metrics (including degree, strength, clustering coefficient, betweenness centrality, nodal efficiency) to represent brain network's global and regional properties. All graph measures were calculated using the package Brain Connectivity Toolbox (https://sites.google.com/site/bctnet/). 

Statistical analysis
Sparse Canonical Correlation Analysis
To examine a latent mode of covariation between structural brain network properties and various polygenic scores, environmental factors, and phenotypic outcomes, we used pairwise sparse canonical correlation analysis (Witten et al., 2009) between brain network measures and three types of non-imaging data (i.e., PGSs, environmental variables, phenotype variables) separately. While traditional CCA is a standard approach for identifying multivariate associations, it is highly susceptible to overfitting and weight instability, especially when data features are high-dimensional and strongly collinear (e.g., brain network metrics). SCCA addresses these challenges by incorporating L1 regularization, which enforces sparsity in the canonical weights. This regularization not only improves interpretability by highlighting the most relevant features but also enhances the stability and generalizability of the identified patterns. We chose SCCA to ensure that the resulting modes of covariation were robust and not driven by noise or redundant information within the high-dimensional brain network data.
The most popular algorithm for sparse canonical correlation analysis is penalized matrix decomposition (PMD) (Witten et al., 2009), which solves optimization problem of below equation for given two sets of data matrix X_(n×p), Y_(n×q). (n: sample size; p, q: the number of variables of domain X and Y respectively; u, v: canonical weights of domain X and Y respectively; c1, c2: regularization parameter)
max⁡〖cov(Xu,   Yv)〗
s.t. ∥u∥_2=∥v∥_2=1, ∥u∥_1≤c_1, ∥v∥_1≤c_2
To interpret Witten's sparse canonical correlation analysis as correlation maximization, we need to assume covariance matrices X^T X, Y^T Y are identity matrices (Witten et al., 2009). But in our study with the high dimensional brain datasets, the assumption is hardly satisfied. For this reason, we interpreted Witten's sparse canonical correlation analysis as a maximizing covariance algorithm between two sets of variables rather than maximizing correlation.
To evaluate the generalizability of the SCCA results, we partitioned the dataset into training, test, and external validation sets. First, we established a site-based external validation set by holding out two large ABCD study sites in their entirety (together accounting for ~10% of the total sample). These sites, each representing approximately 5% of the total cohort, were selected to ensure a balanced and well-powered evaluation on entirely unseen acquisition sites, thereby testing whether our findings were robust to site-specific biases. The remaining 90% of the data were then divided into a training set (70%) and a held-out test set (20%) using a site-stratified split to ensure that both sets maintained representative site distributions.
For the sparse canonical correlation analysis with PGS and brain network measures, we only used participants classified as genetically European ancestry to control genetic confounding effects as the main analysis. To ensure that these analyses generalize to a multiethnic dataset, we conducted additional analyses on the multiethnic dataset. In the multiethnic analysis, genetic ancestry was included as an additional covariate. Table 1 and Supplementary Table 1 summarize the demographic information of the samples included in main and supplementary analysis, respectively.
Table 1. Demographic information of the main analysis participants.
	 	PGS – BNM (n=5,784) 	ENV – BNM (n=10,343) 	Pheno – BNM (n=10,343) 
	 	train 	test 	train 	test 	train 	test 
N	total	4,626	1,157	8,274	2,069	8,274	2,069
Sex	Male 	2,453	627	4,343	1,065	4,343	1,065
	Female 	2,172	529	3,929	1,003	3,929	1,003
	Other	1	1	2	1	2	1
Race	White 	3,225	802	4,350	1,128	4,350	1,128
	Black 	29	7	1,194	295	1,194	295
	Hispanic 	902	223	1,686	408	1,686	408
	Asian 	8	0	173	37	173	37
	Other 	462	125	871	201	871	201

Prior to the main analysis, one-way ANOVA confirmed statistically significant site-related variability across 98.4% of brain network measures (median η^2 = 0.056, maximum η^2 = 0.342), necessitating the control of site effects. To account for these site-related variations along with other potential biases, we controlled for confounding effects from age, sex, self-reported race/ethnicity, ABCD study site, and handedness. Similar to (Modabbernia et al., 2021), we controlled these potential confounding effects by regressing out the variance explained by age, sex, age * sex, age^2, age^2 * sex, self-reported race/ethnicity, ABCD study site, and handedness from all variables prior to performing SCCA analysis. For the external validation set, which comprised sites not included in the training model, we regressed out site effects by using the largest site in the training set as the reference baseline. For binary variables such as KSADS diagnosis, we used logistic regression to regress out these effects. The residualized data was then used as input for sparse canonical correlation analysis (SCCA). We used SCCA_PMD function from the Python 'cca-zoo' package. To ensure that the main findings are robust and not driven by the selection of specific covariates, we performed additional analyses using a reduced set of covariates (age, sex, self-reported race/ethnicity, ABCD study site, and handedness). Furthermore, considering that race/ethnicity in the U.S. context is deeply intertwined with socioeconomic factors, we conducted a sensitivity analysis for the environment–brain network multivariate associations to evaluate the impact of regressing out race/ethnicity from environmental variables.
We selected optimal L1 regularization parameters from 5-fold cross validation searching from 0.1 to 1 with a step size of 0.05 for both X and Y variables respectively. We selected the L1 regularization parameters that yielded the highest covariance between the first pair of canonical variates in the validation data across the five cross-validation folds.
To determine the number of SCCA modes, we first examined canonical covariance scree plots, which showed that the dominant associations were captured in the first two to three modes (Supplementary Figure S2). Nevertheless, to explore potential multivariate patterns, we extracted five modes of covariance for each SCCA. The statistical significance of each mode was then evaluated using a permutation test (5,000 iterations), with p-values calculated based on the distribution of permuted covariances and FDR-corrected within each analysis.
p_uncorrected=N_(null cov > cov)/N_null 
Selected variables and their loading depend on the input sample. To find variables reliably related to each mode, we used bootstrap resampling. We randomly resampled 5,000 times with replacement and assessed the 95% confidence interval of each variable's loading and how consistently it was selected. We interpreted the significant modes based on loading patterns of variables whose 95% confidence interval of loading does not cross zero (Xia et al., 2018) and selected more frequently than expected by chance (i.e., more frequently selected than expected by binomial distribution). Because sparse canonical correlation analysis with bootstrap sample may change the order of components (axis rotation) and signs (reflection) (Misic et al., 2016; Xia et al., 2018), the re-alignment procedure is needed to estimate confidence interval of loading properly. We matched the components and signs based on cosine similarity of weight vectors obtained from original dataset and bootstrap sample. To assess the reproducibility of the findings, we applied the model to the held-out test set and estimated significance of each mode through the permutation test.
Mediation Analysis
After performing sparse canonical correlation analysis (SCCA), we tested whether brain network properties mediate the influence of genetic and environmental factors on cognitive and psychiatric phenotypes. Since SCCA identifies latent modes of covariation between brain network properties and multiple domains, the SCCA-derived variates serve as optimal summary representations that capture the dominant axes of covariation among brain network properties, genetic predispositions, environmental influences, and phenotypic traits. We used these summary scores in mediation analysis to test the hypothesized gene/environment–brain network–phenotype pathway while reducing high-dimensional data into interpretable components.
Specifically, in the mediation model (X→M→Y), the independent variable (X) was defined as the genetic or environmental latent variate derived from the SCCA between the respective domain and brain network measures. The mediator (M) and the outcome (Y) were defined as the brain network and phenotypic latent variates, respectively, derived from the SCCA between brain network measures and phenotypic traits. We used the same covariates as in the SCCA, which include age, sex, age * sex, age^2, age^2 * sex, self-reported race/ethnicity, ABCD study site, and handedness. The two-sided p-values for each path were estimated from 500 bootstrap samples using the mediation_analysis function from the Python 'pingouin' package. Recognizing that race/ethnicity in the U.S. context is deeply intertwined with environmental exposures and can influence neurodevelopmental trajectories, we first evaluated the impact of controlling for race/ethnicity as a covariate on the mediation results. Subsequently, we conducted exploratory subgroup analyses within the two largest groups (White and Hispanic) to ensure that the observed mediation patterns were not artifacts driven by covariation with race/ethnicity.
